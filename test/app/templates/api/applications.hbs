<div class="columns small-12">
  <div class="Box">
    <div class="api-section row">
      <div class="columns small-12 u-mb-3">
        <div class="headline-group u-clearfix">
          {{#unless isReadOnly}}
            {{#link-to 'api.applications.new' class="Button Button--small u-floatRight"}}Register New Application{{/link-to}}
          {{/unless}}
          <h2>Your applications</h2>
          <p>Applications you have registered to use the <a href="https://developers.digitalocean.com/documentation/v2/">DigitalOcean API.</a></p>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="columns small-12">
        {{#if emptyState}}
          <div class="EmptyState--simple u-clearfix">
            <p>You have no applications registered to your account.</p>
          </div>
        {{else}}
          <table class="u-mb-3 stack-section api-table">
            <thead>
              <tr>
                {{table-header action="sort" isLoading=sorting sortCol=sort sortDir=sort_direction col="name" colClass="long-name" text="Name"}}
                {{table-header action="sort" isLoading=sorting sortCol=sort sortDir=sort_direction col="created_at" text="Created"}}
                {{#unless isReadOnly}}
                  {{table-header col="action" noSorting=true}}
                {{/unless}}
              </tr>
            </thead>
            <tbody>
              {{#each filteredModel as |application|}}
                <tr>
                  <td class="long-name">
                      {{#ellipsis-text text=application.name text2=application.url}}
                        {{#link-to 'api.applications.details' application}}
                          {{application.name}}
                        {{/link-to}}
                        <span class="small">({{application.url}})</span>
                      {{/ellipsis-text}}
                  </td>
                  <td class="created">
                    {{date-to-human-time date=application.createdAt}}
                  </td>
                  {{#unless isReadOnly}}
                    <td class="action stackRight">
                      <div class="u-floatRight">
                        {{#if application.isDeleted}}
                          {{loading-spinner message="Deleting"}}
                        {{else if application.isSaving}}
                          {{loading-spinner message="Saving"}}
                        {{else}}
                          <div class="app-more-wrap">
                            {{dropdown-menu closeOnClick=true title="More" items=menuItems action="menuItemClick" actionParams=application}}
                          </div>
                        {{/if}}
                      </div>
                    </td>
                  {{/unless}}
                </tr>
              {{/each}}
            </tbody>
          </table>
        {{/if}}
        {{#if needsPagination}}
          {{paginator-full
            linkToPage="api.applications"
            isLoading=paginating
            pages=model.meta.pagination.pages
            currentPage=model.meta.pagination.current_page
            action="changePage"
            scrollToAfterLoad="#aurora-container"
          }}
        {{/if}}
      </div>
    </div>
  </div>
</div>

{{#if deleteApplication}}
  {{#modal-window title="Delete Application" contentClasses="confirm-small" size="small" saveText="Delete Application" saveClasses="Button--red" onHide="onModalHide"}}
    <p class="u-grey">Are you sure you want to delete this application?</p>
  {{/modal-window}}
{{/if}}
